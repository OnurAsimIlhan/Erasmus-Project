<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    crossorigin="anonymous" />

  <title>{% block title %} University Management {% endblock %}</title>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbar">
      <div class="navbar-nav">
        <form method="POST">
        <a class="nav-item nav-link" href="/ec/home">Home</a>
        </form>
        {% for role in user.role %}
        {% if role.role == "Course Coordinator" %}
          <a class="nav-item nav-link" href="/cchome">Switch to Course Coordinator</a>
        {% endif %}
        {% endfor %}
        <a class="nav-item nav-link" href="/">Upload Final Form</a>
        <a class="nav-item nav-link" href="/faq/update/department={{user_service.getUserById(user.bilkent_id).department}}">Update FAQ</a>
        <a class="nav-item nav-link" href="/ec/applications/">View Student Applications</a>
        <a class="nav-item nav-link" href="/ec/application_period/create/department={{user.department}}">Open Application Period</a>
        <a class="nav-item nav-link" href="/ec/courses">View Course Proposals</a>
        <a class="nav-item nav-link" href="/ec/universities">Universities</a>
        <a class="nav-item nav-link" href="/logout">Logout</a>
      </div>
    </div>
  </nav>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        {% if category == 'error' %}
          <div class = "alert alert-danger alert-dismissable fade show" role="alert">
            {{ message }}
            <button type="button" class="close" data-dismiss="alert">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
        {% else %}
          <div class = "alert alert-success alert-dismissable fade show" role="alert">
            {{ message }}
            <button type="button" class="close" data-dismiss="alert">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
        {% endif %}
      {% endfor %}
    {% endif %}
  {% endwith %}

  <form method="POST">
    <h1 style="text-align: center;">Universities</h1>
    <br><br>
    
    <div class="form-group">
      <label for="name">University Name</label>
      <input
        type="text"
        class="form-control"
        id="name"
        name="name"
        placeholder="Enter university name"
        required
      />
      <label for="country">Country</label>
      <input
        type="text"
        class="form-control"
        id="country"
        name="country"
        placeholder="Enter country"
        required
      />
      <label for="semester">Semesters</label>
      <select class="form-control" id ="semester" name="semester">
        <option value="default">Select available semesters</option>
        <option value="fall">Fall</option>
        <option value="spring">Spring</option>
        <option value="both">Both</option>
      </select>
      <label for="language">Language Requirements</label>
      <input
        type="text"
        class="form-control"
        id="language"
        name="language"
        placeholder="Enter language requirements"
        required
      />
      <label for="quota">Total Quota</label>
      <input
        type="number"
        class="form-control"
        id="quota"
        name="quota"
        placeholder="Enter total quota"
        required
      />
    </div>
    <button type="submit" class="open" name="add_university">
      Add University
    </button>
  </form>
  <br>
  <table>
    <tr>
      <th>University</th>
      <th>Country</th>
      <th>Semesters</th>
      <th>Language Requirements</th>
      <th>Total Quota</th>
      <th>Remaining Quota</th>
    </tr>
    {% for university in universities %}
    <tr>
      <form action="" method="POST" >
      <div class="form-group">
        <td>
          <input
            type="text"
            id="update_name"
            name="update_name"
            value="{{ university.name }}"
            required
          />
        </td>
        <td>
          <input
            type="text"
            id="update_country"
            name="update_country"
            value="{{ university.country }}"
            required
          />
        </td>
        <td>
          <select class="form-control" id ="update_semester" name="update_semester">
            {% if university.semester == "fall" %}
            <option value="fall" selected>Fall</option>
            <option value="spring">Spring</option>
            <option value="both">Both</option>
            {% elif university.semester == "spring" %}
            <option value="fall">Fall</option>
            <option value="spring" selected>Spring</option>
            <option value="both">Both</option>
            {% elif university.semester == "both" %}
            <option value="fall">Fall</option>
            <option value="spring">Spring</option>
            <option value="both" selected>Both</option>
            {% endif %}
          </select>
        </td>
        <td>
          <input
            type="text"
            id="update_language"
            name="update_language"
            value="{{ university.language_requirements }}"
            required
          />
        </td>
        <td>
          <input
            type="number"
            id="update_total_quota"
            name="update_total_quota"
            value="{{ university.total_quota }}"
            required
          />
        </td>
        <td>
          <input
            type="number"
            id="update_remaining_quota"
            name="update_remaining_quota"
            value="{{ university.remaining_quota }}"
            required
            readonly
            />
        </td>
      </div>
        <td>
          <button type="submit" class="open" name="update" value="{{ university.university_id }}">
              Update
          </button>
        </td>
    </form>
    </tr>
    {% endfor %}
  </table>
</body>

</html>